(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chat"],{4398:function(t,e,n){"use strict";var s=n("ebaa"),a=n.n(s);a.a},"498a":function(t,e,n){"use strict";var s=n("23e7"),a=n("58a8").trim,r=n("c8d2");s({target:"String",proto:!0,forced:r("trim")},{trim:function(){return a(this)}})},"65ce":function(t,e,n){},"7e85":function(t,e,n){},"7f01":function(t,e,n){"use strict";var s=n("a30b"),a=n.n(s);a.a},a30b:function(t,e,n){},bc78:function(t,e,n){"use strict";var s=n("65ce"),a=n.n(s);a.a},c8d2:function(t,e,n){var s=n("d039"),a=n("5899"),r="​᠎";t.exports=function(t){return s((function(){return!!a[t]()||r[t]()!=r||a[t].name!==t}))}},c98b:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{},[n("div",{staticClass:"sidebar"},[n("h4",{staticClass:"title"},[t._v(" New conversation ")]),t._l(t.groups,(function(t){return n("ChatUsers",{key:t.group.id,attrs:{chat:t.group,participantId:t.participantId}})}))],2),n("div",{staticClass:"chats"},t._l(t.conversations,(function(t,e){return n("app-conversation",{key:e,attrs:{conversation:t}})})),1),n("div",{staticClass:"sidebar"},[n("h4",{staticClass:"title"},[t._v("Existing conversations")]),n("b-list-group",[n("b-list-group-item",t._l(t.existingConversations,(function(t){return n("ExistingConversation",{key:t.id,attrs:{data:t}})})),1)],1)],1)])},a=[],r=(n("96cf"),n("1da1")),i=n("5530"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"group"},[n("b-button",{staticClass:"d-flex align-items-center mt-2",attrs:{block:"",variant:"info"},on:{click:t.toggle}},[n("b-avatar",{staticClass:"mr-2",attrs:{size:"20",icon:"image"}}),n("p",{staticClass:"my-auto"},[t._v(" "+t._s(t.truncate(t.chat.name,15))+" ")])],1),t.open&&t.otherUsers.length?n("b-list-group",{staticClass:"users mt-2"},t._l(t.otherUsers,(function(e){return n("b-list-group-item",{key:e.id,staticClass:"list-item",on:{click:function(n){return t.openConversation(e.id)}}},[n("div",{staticClass:"d-flex flex-row align-items-center"},[n("b-avatar",{staticClass:"mr-2",attrs:{size:"30"}}),n("p",{staticClass:"my-auto"},[t._v(" "+t._s(e.nickname)+" ")])],1)])})),1):t._e(),t.open&&!t.otherUsers.length?n("div",[n("p",[t._v("No users in group")])]):t._e()],1)},c=[],u=(n("4de4"),n("a9e3"),n("fb6a"),n("498a"),function(t,e){return t.length>=e?t.slice(0,e).trim()+"...":t}),p={props:{chat:{type:Object,required:!0},participantId:{type:[Number,String],required:!0}},data:function(){return{open:!1,users:[]}},computed:{otherUsers:function(){var t=this;return this.users.filter((function(e){return e.id!==t.participantId}))}},methods:{truncate:u,toggle:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.open){e.next=4;break}t.open=!1,e.next=7;break;case 4:return e.next=6,t.fetchUsers();case 6:t.open=!0;case 7:case"end":return e.stop()}}),e)})))()},fetchUsers:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$http.group.getParticipants(t.chat.id);case 3:n=e.sent,s=n.data,t.users=s,t.open=!0,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),t.$alert.display(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},openConversation:function(t){var e="/app/conversation/new/".concat(t);this.$store.state.chats.stompClient.send(e,{},JSON.stringify({participantId:this.participantId,type:"NEW"}))}}},l=p,v=(n("7f01"),n("2877")),f=Object(v["a"])(l,o,c,!1,null,"8c7eca28",null),m=f.exports,d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"conversation"},[n("div",{staticClass:"conversation__toolbar mb-1"},[n("div",{staticClass:"d-flex align-items-center"},[n("b-avatar",{staticClass:"mr-2",attrs:{icon:"image"}}),n("p",{staticClass:"my-auto"},[t._v(" "+t._s(t.conversation.name)+" ")])],1),n("b-button-group",{staticClass:"mb-2"},[n("b-button",{attrs:{variant:"success"},on:{click:t.openConversationSettings}},[n("b-icon-gear-wide")],1),n("b-button",{staticClass:"closeButton",attrs:{variant:"danger"},on:{click:function(e){return t.closeConversation(t.conversation.id)}}},[n("b-icon-x")],1)],1)],1),n("div",{directives:[{name:"chat-scroll",rawName:"v-chat-scroll"}],staticClass:"conversation__content"},t._l(t.conversation.content,(function(e,s){return n("b-alert",{key:s,class:["message",{message__own:e.participantId===t.conversation.user}],attrs:{variant:e.participantId===t.conversation.user?"success":"info",show:""}},[n("div",{staticClass:"d-flex flex-row align-items-center"},[n("b-avatar",{staticClass:"mr-2",attrs:{size:"30"}}),n("h5",[t._v(t._s(t.conversation.userList[e.participantId]))])],1),n("p",[t._v(t._s(e.content))])])})),1),n("form",{on:{submit:function(e){return e.preventDefault(),t.sendMessage(e)}}},[n("b-input-group",{staticClass:"mt-2"},[n("b-input",{attrs:{type:"text",required:""},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),n("b-input-group-append",[n("b-button",{attrs:{type:"submit",variant:"primary"}},[t._v("SEND")])],1)],1)],1)])},h=[],g=n("2f62"),b=(n("a15b"),function(t){var e=t.join(", ");return e.length>20?e.slice(0,20)+"...":e}),C={props:["conversation"],data:function(){return{message:""}},computed:Object(i["a"])({},Object(g["b"])({stompClient:function(t){return t.user.stompClient}})),methods:{chatUserNames:b,closeConversation:function(t){this.$store.commit("chats/CLOSE_CONVERSATION",t)},sendMessage:function(){if(this.message.trim().length){var t="/app/conversation/".concat(this.conversation.id,"/sendmessage");this.$store.state.chats.stompClient.send(t,{},JSON.stringify({participantId:this.conversation.user,content:this.message,type:"CHAT"}))}this.message=""},openConversationSettings:function(){this.openModal("conversationSettings",this.conversation)}}},_=C,x=(n("4398"),Object(v["a"])(_,d,h,!1,null,"349c7874",null)),w=x.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"group",on:{click:function(e){return t.openConversation(t.data.id)}}},[t._v(" "+t._s(t.data.name||t.chatUserNames(this.data.participants.map((function(t){return t.nickname}))))+" ")])},O=[],y=(n("b0c0"),{props:{data:Object},data:function(){return{users:[]}},methods:{chatUserNames:b,openConversation:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var s,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.$http.chat.getConversationMessages(t);case 2:s=n.sent,a=s.data,a.name=e.data.name,e.$store.commit("chats/CREATE_CONVERSATION",a);case 6:case"end":return n.stop()}}),n)})))()}}}),E=y,j=(n("ce72"),Object(v["a"])(E,k,O,!1,null,"156dafeb",null)),N=j.exports,S={components:{appConversation:w,ChatUsers:m,ExistingConversation:N},computed:Object(i["a"])({},Object(g["b"])({groups:function(t){return t.user.groups},conversations:function(t){return t.chats.conversations},existingConversations:function(t){return t.chats.existingConversations}})),created:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getExistingConversations();case 2:case"end":return e.stop()}}),e)})))()},methods:{openChatSearch:function(){this.openModal("chatSelect")},getExistingConversations:function(){this.$store.dispatch("chats/getExistingConversations")}}},I=S,$=(n("bc78"),Object(v["a"])(I,s,a,!1,null,"6aff5b8d",null));e["default"]=$.exports},ce72:function(t,e,n){"use strict";var s=n("7e85"),a=n.n(s);a.a},ebaa:function(t,e,n){}}]);
//# sourceMappingURL=chat.1a3180c1.js.map